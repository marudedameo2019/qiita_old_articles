---
title: Ubuntuの要らないパッケージを削除する
tags: Ubuntu
author: dameyodamedame
slide: false
---
# 序

なんか必要なビルドをしたいから、必要なソフトを動かしたいから、様々な理由でUbuntuにはいろいろなパッケージをインストールします。

```console
$ sudo apt install something_app_or_lib
...
```
みたいなやつです。1つのパッケージを入れると依存してるパッケージや関連してるパッケージも追加でどんどん入ってしまいます。

しかし、ちょっと使ってみてやっぱだめだった、とか、やること終わったのでもう要らない、とか、そういうパッケージも結構あると思います。そんなとき、簡単お手軽にインストールできたパッケージが今度は楽にアンインストールできるのか？というとそうではなかったりします。

今日はアンインストール方法について、書いてみます。

# パッケージのアンインストール

まず単品のパッケージアンインストールです。

## apt remove

```console
$ sudo apt remove something_app_or_lib
...
```

一般的にはコレです。しかしこれには**2つ注意点があります**。

- 対象パッケージは削除されるが、**依存パッケージや関連パッケージは削除されない**
- **設定ファイルなどはそのまま残る**

## apt purge

```console
$ sudo apt purge something_app_or_lib
...
```
コレを使うと設定ファイルも消してくれます。二度と使わない場合はこちらにしましょう。ただし依存パッケージや関連パッケージは消えません。

# 不要な依存パッケージの消し方

```console
$ sudo apt autoremove
...
```
aptを使っていると、ログにautoremoveしろとはよく出てきますよね。アレです。

aptでは、

- 指定してインストールしたパッケージ と
- 単に依存や関連パッケージとして芋づる式にインストールしたパッケージ を

区別して記録しています。なので、指定してインストールしたパッケージのどれにも繋がらない浮いてしまっているパッケージを探して、まとめてアンインストールすることができます。その機能が`apt autoremove`というわけです。こまめにやっておくと良いでしょう。

ただし、たまたま残っていた浮いたパッケージに含まれるライブラリなどを、たまたまパッケージ管理していないソフトから使っていたりすると、いきなり動かなくなった、みたいな事例も稀にあります。

そして`apt purge`と同様に`apt autopurge`も存在します。使ったことはありません。

# そういやこないだ入れたパッケージなんだっけ？

いつもいつも入れたパッケージを正確に覚えてる人もなかなかいないと思います。そんなとき、aptが残してくれているログにそのパッケージ名が残っているかもしれません。

```console
$ zgrep --color -n -E '^Commandline: (apt|apt-get) ' /var/log/apt/history.log /var/log/apt/history.log.*.gz
```

# 最後に

詳しくはマニュアルページ参照
https://manpages.ubuntu.com/manpages/noble/ja/man8/apt.8.html

